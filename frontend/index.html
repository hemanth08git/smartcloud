<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Smart Food Production & Quality Monitoring</title>
  <link rel="stylesheet" href="style.css" />
</head>
<body>
  <header class="top-bar">
    <div class="logo">SmartFood Cloud</div>
    <div class="env-label">Local Environment</div>
  </header>

  <main class="container">
    <aside class="sidebar">
      <nav>
        <button class="nav-btn active" data-target="dashboard">Dashboard</button>
        <button class="nav-btn" data-target="products">Products</button>
        <button class="nav-btn" data-target="batches">Batches</button>
        <button class="nav-btn" data-target="inspections">Inspections</button>
        <button class="nav-btn" data-target="alerts">Alerts</button>
        <!-- NEW: Sensor Anomaly nav -->
        <button class="nav-btn" data-target="sensor-anomaly-section">Sensor Anomaly</button>
      </nav>
      <div class="backend-status" id="backendStatus">Checking backend...</div>
    </aside>

    <section class="content">
      <section id="dashboard" class="panel active">
        <h1>Cloud Quality Dashboard</h1>
        <div class="cards">
          <div class="card">
            <div class="card-label">Total Products</div>
            <div class="card-value" id="totalProducts">-</div>
          </div>
          <div class="card">
            <div class="card-label">Total Batches</div>
            <div class="card-value" id="totalBatches">-</div>
          </div>
          <div class="card">
            <div class="card-label">High Risk</div>
            <div class="card-value high" id="highRisk">-</div>
          </div>
          <div class="card">
            <div class="card-label">Medium Risk</div>
            <div class="card-value medium" id="mediumRisk">-</div>
          </div>
          <div class="card">
            <div class="card-label">Low Risk</div>
            <div class="card-value low" id="lowRisk">-</div>
          </div>
          <div class="card">
            <div class="card-label">Unknown Risk</div>
            <div class="card-value" id="unknownRisk">-</div>
          </div>
        </div>
      </section>

      <section id="products" class="panel">
        <h1>Products</h1>
        <div class="layout">
          <form id="productForm" class="form-card">
            <h2>Add / Update Product</h2>
            <input type="hidden" id="productId" />
            <label>Name
              <input type="text" id="productName" required />
            </label>
            <label>Category
              <input type="text" id="productCategory" />
            </label>
            <label>Description
              <textarea id="productDescription"></textarea>
            </label>
            <div class="form-actions">
              <button type="submit">Save</button>
              <button type="button" id="productResetBtn" class="secondary">Reset</button>
            </div>
          </form>
          <div class="table-card">
            <h2>Existing Products</h2>
            <table>
              <thead>
                <tr>
                  <th>ID</th><th>Name</th><th>Category</th><th>Actions</th>
                </tr>
              </thead>
              <tbody id="productsTableBody"></tbody>
            </table>
          </div>
        </div>
      </section>

      <section id="batches" class="panel">
        <h1>Batches</h1>
        <div class="layout">
          <form id="batchForm" class="form-card">
            <h2>Create Batch</h2>
            <label>Product
              <select id="batchProductId"></select>
            </label>
            <label>Batch Code
              <input type="text" id="batchCode" placeholder="BATCH-2025-001" required />
            </label>
            <label>Line ID
              <input type="text" id="batchLineId" placeholder="LINE-1" />
            </label>
            <button type="submit">Create</button>
          </form>
          <div class="table-card">
            <h2>Existing Batches</h2>
            <table>
              <thead>
                <tr>
                  <th>ID</th><th>Code</th><th>Product</th><th>Status</th><th>Risk</th><th>Actions</th>
                </tr>
              </thead>
              <tbody id="batchesTableBody"></tbody>
            </table>
          </div>
        </div>
      </section>

      <section id="inspections" class="panel">
        <h1>Inspections & Sensor Data</h1>
        <div class="layout">
          <form id="inspectionForm" class="form-card">
            <h2>New Inspection</h2>
            <label>Batch
              <select id="inspectionBatchId"></select>
            </label>
            <label>Temperature (°C)
              <input type="number" step="0.1" id="inspectionTemp" required />
            </label>
            <label>Humidity (%)
              <input type="number" step="0.1" id="inspectionHumidity" />
            </label>
            <label>pH
              <input type="number" step="0.1" id="inspectionPh" />
            </label>
            <label>Microbial Result
              <select id="inspectionMicrobial">
                <option value="PENDING">PENDING</option>
                <option value="PASS">PASS</option>
                <option value="FAIL">FAIL</option>
              </select>
            </label>
            <label>Notes
              <textarea id="inspectionNotes"></textarea>
            </label>
            <button type="submit">Create Inspection</button>
          </form>

          <form id="sensorForm" class="form-card">
            <h2>Add Sensor Reading</h2>
            <label>Batch
              <select id="sensorBatchId"></select>
            </label>
            <label>Temperature (°C)
              <input type="number" step="0.1" id="sensorTemp" required />
            </label>
            <label>Humidity (%)
              <input type="number" step="0.1" id="sensorHumidity" />
            </label>
            <button type="submit">Add Reading</button>
          </form>
        </div>
      </section>

      <section id="alerts" class="panel">
        <h1>Alerts</h1>
        <div class="table-card">
          <h2>Recent Alerts</h2>
          <table>
            <thead>
              <tr>
                <th>Time</th><th>Batch ID</th><th>Level</th><th>Message</th>
              </tr>
            </thead>
            <tbody id="alertsTableBody"></tbody>
          </table>
        </div>
      </section>

      <!-- NEW: Sensor Anomaly panel -->
      <section id="sensor-anomaly-section" class="panel">
        <h1>Sensor Anomaly Check</h1>
        <div class="layout">
          <form id="sensorAnomalyForm" class="form-card">
            <h2>Analyze Current Reading</h2>
            <label>Batch ID
              <input type="number" id="anomalyBatchId" required />
            </label>
            <label>Current Temperature (°C)
              <input type="number" step="0.1" id="currentTemp" required />
            </label>
            <label>Current Humidity (%)
              <input type="number" step="0.1" id="currentHumidity" required />
            </label>
            <button type="submit">Analyze</button>
          </form>

          <div class="table-card">
            <h2>Anomaly Result</h2>
            <div id="sensorAnomalyResult" class="anomaly-result">
              <p><strong>Status:</strong> <span id="anomalyStatus">–</span></p>
              <p><strong>Risk Level:</strong> <span id="anomalyLevel">–</span></p>
              <p><strong>Score:</strong> <span id="anomalyScore">–</span></p>
              <p><strong>Message:</strong> <span id="anomalyMessage">Submit a reading to analyze.</span></p>
            </div>
          </div>
        </div>
      </section>
      <!-- END Sensor Anomaly panel -->

    </section>
  </main>

  <footer class="footer">
    SmartFood Cloud &mdash; Demo UI
  </footer>

  <script src="script.js"></script>
</body>
</html>
